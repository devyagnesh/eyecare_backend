---
alwaysApply: true
---

# Eyecare Admin Panel – Cursor AI Ruleset (v3.1)
# Author: Keplersoft.in
# Purpose: Force Cursor AI to use existing theme assets and generate scalable Laravel + jQuery-based code.

---

project:
  name: "Eyecare API & Admin Panel"
  framework: "Laravel 12"
  theme_path: "./resources/theme/zynix/dist"
  frontend: "jQuery + DataTables + Theme Assets"
  backend: "Laravel MVC + Service Layer"

---

rules:
  # ==========================
  # 1. Theme & UI Integration
  # ==========================
  - description: "Use only existing Zynix theme from theme_path"
    enforcement: "strict"
    conditions:
      - "Never create or modify CSS files"
      - "Do not write inline CSS or JS"
      - "Do not import from CDN"
    code:
      - "Use existing HTML structure and classes from the theme."
      - "If a layout or style is needed, locate and reuse it from theme assets."
      - "If a component doesn't exist in the theme, skip or adapt from available markup."

  - description: "Theme Assets Loading"
    enforce_asset_path: true
    asset_resolution: "relative"
    asset_reference_method: "Laravel asset() helper"
    asset_validation: true

---

  # ==========================
  # 2. Backend Architecture
  # ==========================
  - description: "Maintain service-oriented Laravel structure"
    enforce_structure: true
    directories:
      services: "app/Services"
      repositories: "app/Repositories"
      requests: "app/Http/Requests"
    code:
      - "Controllers must only handle request/response, not logic."
      - "Inject all business logic via Service Layer using Dependency Injection."
      - |
        example:
          public function __construct(
              private EyeExamService $eyeExamService
          ) {}

  - description: "Validation and Error Handling"
    enforce_form_requests: true
    validation_examples:
      axis: "integer|min:0|max:180"
      sphere: "numeric|min:-20|max:20"
      pd: "integer|min:40|max:80"
      iop: "integer|min:5|max:60"
    json_error_format: |
      {
        "success": false,
        "error_code": "VALIDATION_ERROR",
        "message": "The provided data is invalid."
      }

---

  # ==========================
  # 3. API Standards
  # ==========================
  - description: "RESTful API conventions"
    base_path: "/api/v1"
    json_response_format: |
      {
        "success": true,
        "data": {},
        "errors": null,
        "message": "Success",
        "timestamp": "ISO8601"
      }
    enforce_rest_conventions: true
    enforce_versioning: true
    enable_caching: true

---

  # ==========================
  # 4. Frontend Behavior
  # ==========================
  - description: "Frontend scripting standards"
    allow_frameworks:
      - "jQuery"
    disallow_frameworks:
      - "React"
      - "Vue"
      - "Angular"
    js_location: "public/assets/js/app.js"
    validation_library: "jQuery Validation Plugin"
    table_library: "DataTables (server-side when >1000 rows)"
    enforce_modular_js: true
    code:
      - "All event handlers and AJAX calls must be defined in modular functions."
      - "All AJAX responses must match standardized JSON schema."

---

  # ==========================
  # 5. Security & Middleware
  # ==========================
  - description: "Security enforcement"
    use_auth: "Laravel Sanctum"
    enforce_https: true
    enforce_csp: true
    sanitize_inputs: true
    log_sensitive_actions: true
    encryption: "Laravel Crypt/Hash"

---

  # ==========================
  # 6. Database & Auditing
  # ==========================
  - description: "Database integrity and soft deletes"
    enforce_foreign_keys: true
    add_audit_columns:
      - "created_by"
      - "updated_by"
    use_soft_deletes: true

---

  # ==========================
  # 7. RBAC
  # ==========================
  - description: "Roles & Permissions"
    library: "spatie/laravel-permission"
    enforce_backend_permissions: true
    enforce_frontend_permissions: true
    log_role_changes: true

---

  # ==========================
  # 8. CI/CD & Quality
  # ==========================
  - description: "CI pipeline rules"
    required_files:
      - "README.md"
      - "SECURITY.md"
      - "CHANGELOG.md"
    fail_on_missing_assets: true
    static_analysis:
      - "PHPStan"
      - "Larastan"
    test_requirements:
      - "Unit tests for services"
      - "Feature tests for APIs"

---

cursor_behavior:
  execution_policy:
    - "Never write inline CSS or JS."
    - "Never use external CDN links."
    - "Always import UI components from theme_path."
    - "Always apply PSR-12, SOLID, and DRY principles."
    - "Always inject services via constructor (DI)."
    - "Always validate using FormRequests."
    - "Always sanitize user input."
    - "Always log authentication and permission events."
    - "Always return standardized JSON responses."
    - "Always prioritize maintainability and security."

---

notes:
  - "If theme_path is not accessible, use relative path only."
  - "Cursor must fail build if required assets not found."
  - "Generated output must match theme visually and structurally — no redesigns."

---

[END OF MDC]
